<section class="container my-4">
  <div class="row g-3">
    <!-- Main Slider -->
    <div class="col-md-10">
      <div class="rounded-4 overflow-hidden shadow-sm">
        <owl-carousel-o [options]="customOptionsMain">
          <ng-template carouselSlide>
            <img src="./images/img1.avif" height="350" class="w-100 object-fit-cover" />
          </ng-template>
          <ng-template carouselSlide>
            <img src="./images/img2.avif" height="350" class="w-100 object-fit-cover" />
          </ng-template>
          <ng-template carouselSlide>
            <img src="./images/img3.avif" height="350" class="w-100 object-fit-cover" />
          </ng-template>
          <ng-template carouselSlide>
            <img src="./images/img4.avif" height="350" class="w-100 object-fit-cover" />
          </ng-template>
          <ng-template carouselSlide>
            <img src="./images/img5.avif" height="350" class="w-100 object-fit-cover" />
          </ng-template>
          <ng-template carouselSlide>
            <img src="./images/img6.avif" height="350" class="w-100 object-fit-cover" />
          </ng-template>
          <ng-template carouselSlide>
            <img src="./images/img7.avif" height="350" class="w-100 object-fit-cover" />
          </ng-template>
          <ng-template carouselSlide>
            <img src="./images/new1.avif" height="350" class="w-100" />
          </ng-template>
          <ng-template carouselSlide>
            <img src="./images/new3.avif" height="350" class="w-100" />
          </ng-template>
          <ng-template carouselSlide>
            <img src="./images/new2.gif" height="350" class="w-100" />
          </ng-template>
        </owl-carousel-o>
      </div>
    </div>

    <!-- Side Banners -->
    <div class="col-md-2 d-flex flex-column gap-3">
      <img
        src="./images/grocery-banner.png"
        height="170"
        class="w-100 rounded-4 shadow-sm object-fit-cover"
      />
      <img
        src="./images/grocery-banner-2.jpeg"
        height="170"
        class="w-100 rounded-4 shadow-sm object-fit-cover"
      />
    </div>
  </div>
</section>

<!-- popular categories -->
<section class="container my-5">
  <h2 class="fw-bold mb-3">Popular Categories</h2>

  <owl-carousel-o [options]="customOptionsCategories">
    @for (cat of categoryList.slice(0,6); track cat._id) {
    <ng-template carouselSlide>
      <div class="text-center p-1 category-card">
        <img
          height="230"
          [src]="`${baseURI}/uploads/category/${cat.image}`"
          class="rounded-4 shadow-sm w-100 object-fit-cover"
        />
        <h3 class="h6 mt-2 fw-semibold text-main">{{ cat.name }}</h3>
      </div>
    </ng-template>
    }
  </owl-carousel-o>
</section>

<!-- popular products -->
<section class="container my-5">
  <h2 class="fw-bold mb-3">Popular Products</h2>

  <!-- Search -->
  <input
    [(ngModel)]="searchValue"
    type="search"
    placeholder="Search by product name..."
    class="form-control form-control-lg w-75 mx-auto mb-4 shadow-sm"
  />

  <!-- Product Grid -->
  <div class="row g-4">
    @for (product of productsList.slice(0, 8) | search:searchValue; track $index) {

    <div class="col-6 col-md-4 col-lg-3">
      <div class="product-card rounded-4 shadow-sm p-3 h-100 d-flex flex-column">
        <!-- Link to details -->
        <div [routerLink]="['/details', product._id]" class="cursor-pointer">
          <img
            [src]="`${baseURI}/uploads/images/${product.images[0]}`"
            class="w-100 rounded-3 object-fit-cover"
            height="200"
          />

          <h4 class="small mt-2 text-main fw-bold">{{ product.category.name }}</h4>

          <h3 class="h6 mb-2">{{ product.productName | termtext : 3 }}</h3>

          <!-- Discount + Price -->
          <div class="mt-3">
            <span class="text-success fw-bold">
              {{ ((product.discountPrice / product.price) * 100).toFixed(0) }}% OFF
            </span>

            <div class="mt-2">
              <span class="h5 text-danger fw-bold">
                {{ product.price - product.discountPrice }} EGP
              </span>

              <span class="ms-2 text-muted text-decoration-line-through">
                {{ product.price }} EGP
              </span>
            </div>
            <div class="mt-2">
              <span
                style="font-size: smaller"
                class="text-danger fw-bold"
                *ngIf="product.stock <= 5 && product.stock !== 0"
              >
                {{ product.stock }} items remainig in the stock
              </span>
              <span
                style="font-size: smaller"
                class="text-danger fw-bold"
                *ngIf="product.stock === 0"
              >
                Out of stock
              </span>
            </div>
          </div>
        </div>

        <button
          [disabled]="product.stock === 0"
          (click)="addToCart(product._id)"
          class="btn btn-dark mt-auto w-100 rounded-3"
        >
          Add to Cart
        </button>
      </div>
    </div>

    }
  </div>
</section>

<section class="py-5 bg-light">
  <div class="container">
    <div class="row mb-4 text-center">
      <div class="col">
        <h2 class="fw-bold">What Our Clients Say</h2>
        <p class="text-muted">Real feedback from our valued customers</p>
      </div>
    </div>

    <div class="row g-4">
      <!-- Testimonial 1 -->
      <div class="col-md-4">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-body text-center">
            <p>{{ testData?.description }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<div class="testimony-container">
  <h2>Submit Your Testimony</h2>

  <form [formGroup]="testimonyForm" (ngSubmit)="submitTestimony()">
    <textarea
      formControlName="description"
      placeholder="Write your testimony here..."
      rows="5"
    ></textarea>

    <button type="submit" [disabled]="testimonyForm.invalid">Submit</button>
  </form>
</div>
